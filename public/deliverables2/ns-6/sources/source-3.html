


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > GameScreen</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">io.github.glitchgobblers.screens</a>
</div>

<h1>Coverage Summary for Class: GameScreen (io.github.glitchgobblers.screens)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">GameScreen</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/24)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/78)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/286)
  </span>
</td>
</tr>
  <tr>
    <td class="name">GameScreen$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">GameScreen$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">GameScreen$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$0H0OGQJV</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$0jJLZhKV</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$13jx248D</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$2chlpw63</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$2u3RMbPE</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$4h4XPtJ4</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$BGoxl2or</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$bzOPD98m</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$Ccn3WQqL</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$DQkT82kK</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$guUU6RCW</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$HsL9RnFz</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$JpV2v3RR</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$nK3ripjD</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$nUBOB8OH</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$tIWU8BM6</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$Yo1yKaRU</td>
  </tr>
  <tr>
    <td class="name">GameScreen$MockitoMock$j1IjQ1Wb$auxiliary$yxarAQY8</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/30)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/78)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/295)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package io.github.glitchgobblers.screens;
&nbsp;
&nbsp;import static io.github.glitchgobblers.YettiGame.scaled;
&nbsp;
&nbsp;import com.badlogic.gdx.Gdx;
&nbsp;import com.badlogic.gdx.Input;
&nbsp;import com.badlogic.gdx.Screen;
&nbsp;import com.badlogic.gdx.audio.Sound;
&nbsp;import com.badlogic.gdx.graphics.Color;
&nbsp;import com.badlogic.gdx.graphics.OrthographicCamera;
&nbsp;import com.badlogic.gdx.graphics.Pixmap;
&nbsp;import com.badlogic.gdx.graphics.Texture;
&nbsp;import com.badlogic.gdx.graphics.g2d.GlyphLayout;
&nbsp;import com.badlogic.gdx.graphics.g2d.TextureRegion;
&nbsp;import com.badlogic.gdx.maps.MapObject;
&nbsp;import com.badlogic.gdx.maps.MapObjects;
&nbsp;import com.badlogic.gdx.math.MathUtils;
&nbsp;import com.badlogic.gdx.math.Rectangle;
&nbsp;import com.badlogic.gdx.math.Vector2;
&nbsp;import com.badlogic.gdx.scenes.scene2d.Actor;
&nbsp;import com.badlogic.gdx.scenes.scene2d.Stage;
&nbsp;import com.badlogic.gdx.scenes.scene2d.ui.Button;
&nbsp;import com.badlogic.gdx.scenes.scene2d.ui.Label;
&nbsp;import com.badlogic.gdx.scenes.scene2d.ui.Table;
&nbsp;import com.badlogic.gdx.scenes.scene2d.ui.TextButton;
&nbsp;import com.badlogic.gdx.scenes.scene2d.utils.ChangeListener;
&nbsp;import com.badlogic.gdx.scenes.scene2d.utils.TextureRegionDrawable;
&nbsp;import com.badlogic.gdx.utils.Align;
&nbsp;import com.badlogic.gdx.utils.ScreenUtils;
&nbsp;import io.github.glitchgobblers.EventCounter;
&nbsp;import io.github.glitchgobblers.InputHelper;
&nbsp;import io.github.glitchgobblers.MapManager;
&nbsp;import io.github.glitchgobblers.Timer;
&nbsp;import io.github.glitchgobblers.YettiGame;
&nbsp;import io.github.glitchgobblers.entities.Dean;
&nbsp;import io.github.glitchgobblers.entities.Entity;
&nbsp;import io.github.glitchgobblers.entities.Item;
&nbsp;import io.github.glitchgobblers.entities.Player;
&nbsp;import io.github.glitchgobblers.events.Event;
&nbsp;import io.github.glitchgobblers.events.EventTracker;
&nbsp;import java.util.ArrayList;
&nbsp;
&nbsp;public class GameScreen implements Screen {
&nbsp;  private final YettiGame game;
&nbsp;  private final Stage stage;
&nbsp;  private static final float textDuration = 2f;
&nbsp;  private static final float riseSpeed   = 60f;
&nbsp;  private static final float UI_PADDING_TOP = 12f;
&nbsp;
&nbsp;  private static final int TIMER_LENGTH = 300; // 300s = 5min
&nbsp;
&nbsp;  private Texture playerTexUp;
&nbsp;  private Texture playerTexDown;
&nbsp;  private Texture playerTexLeft;
&nbsp;  private Texture playerTexRight;
&nbsp;  private Texture yetiTexture;
&nbsp;
&nbsp;  private Texture exitTexture;
&nbsp;  private Texture checkinCodeTexture;
&nbsp;  private Texture doorTexture;
&nbsp;  private Texture doorframeTexture;
&nbsp;  private Texture longBoiTexture;
&nbsp;  private Texture waterSpillTexture;
&nbsp;  private Texture pauseTexture;
&nbsp;
&nbsp;  private MapManager mapManager;
&nbsp;  private OrthographicCamera camera;
&nbsp;
&nbsp;  private OrthographicCamera interfaceCamera;
&nbsp;
&nbsp;  private Sound quackSfx;
&nbsp;  private Sound paperSfx;
&nbsp;  private Sound doorSfx;
&nbsp;  private Sound slipSfx;
&nbsp;  private Sound growlSfx;
&nbsp;
&nbsp;  private Player player;
&nbsp;  private Dean dean;
&nbsp;  private Item exit;
<b class="nc">&nbsp;  private final ArrayList&lt;Entity&gt; entities = new ArrayList&lt;&gt;();</b>
&nbsp;  private EventTracker eventTracker;
&nbsp;
&nbsp;  private Label hiddenText;
&nbsp;  private Label negativeText;
&nbsp;  private Label positiveText;
&nbsp;  private Label timerText;
&nbsp;  private Label scoreText;
<b class="nc">&nbsp;  private final ArrayList&lt;Label&gt; messages = new ArrayList&lt;&gt;();</b>
&nbsp;  private Button pauseButton;
&nbsp;
&nbsp;  private Table pauseMenu;
&nbsp;  private Texture btnUpTex;
&nbsp;  private Texture btnDownTex;
&nbsp;
<b class="nc">&nbsp;  private final GlyphLayout nameLayout = new GlyphLayout();</b>
<b class="nc">&nbsp;  private boolean hasPausedOnce = false;</b>
&nbsp;
<b class="nc">&nbsp;  public GameScreen(final YettiGame game) {</b>
<b class="nc">&nbsp;    this.game = game;</b>
<b class="nc">&nbsp;    stage = new Stage(game.viewport, game.batch);</b>
&nbsp;  }
&nbsp;
&nbsp;  @Override
&nbsp;  public void show() {
<b class="nc">&nbsp;    playerTexUp = new Texture(&quot;character/player_up.png&quot;);</b>
<b class="nc">&nbsp;    playerTexDown = new Texture(&quot;character/player_down.png&quot;);</b>
<b class="nc">&nbsp;    playerTexLeft = new Texture(&quot;character/player_left.png&quot;);</b>
<b class="nc">&nbsp;    playerTexRight = new Texture(&quot;character/player_right.png&quot;);</b>
<b class="nc">&nbsp;    yetiTexture = new Texture(&quot;character/yeti.png&quot;);</b>
&nbsp;
<b class="nc">&nbsp;    exitTexture = new Texture(&quot;item/exit.png&quot;);</b>
<b class="nc">&nbsp;    checkinCodeTexture = new Texture(&quot;item/checkin_code.png&quot;);</b>
<b class="nc">&nbsp;    doorTexture = new Texture(&quot;item/door.png&quot;);</b>
<b class="nc">&nbsp;    doorframeTexture = new Texture(&quot;item/doorframe.png&quot;);</b>
<b class="nc">&nbsp;    longBoiTexture = new Texture(&quot;item/long_boi.png&quot;);</b>
<b class="nc">&nbsp;    waterSpillTexture = new Texture(&quot;item/water_spill.png&quot;);</b>
&nbsp;
<b class="nc">&nbsp;    pauseTexture = new Texture(&quot;ui/pause.png&quot;);</b>
&nbsp;
<b class="nc">&nbsp;    camera = new  OrthographicCamera();</b>
<b class="nc">&nbsp;    camera.setToOrtho(false, 90, 60 + UI_PADDING_TOP);</b>
<b class="nc">&nbsp;    camera.position.y -= UI_PADDING_TOP / 2f;</b>
<b class="nc">&nbsp;    camera.update();</b>
<b class="nc">&nbsp;    interfaceCamera = new  OrthographicCamera();</b>
<b class="nc">&nbsp;    interfaceCamera.setToOrtho(false, scaled(16), scaled(9));</b>
<b class="nc">&nbsp;    mapManager = new MapManager(camera);</b>
<b class="nc">&nbsp;    mapManager.loadMap(&quot;map/map.tmx&quot;);</b>
<b class="nc">&nbsp;    EventCounter.reset();</b>
&nbsp;
<b class="nc">&nbsp;    quackSfx = Gdx.audio.newSound(Gdx.files.internal(&quot;audio/duck_quack.mp3&quot;));</b>
<b class="nc">&nbsp;    paperSfx = Gdx.audio.newSound(Gdx.files.internal(&quot;audio/paper_rustle.wav&quot;));</b>
<b class="nc">&nbsp;    doorSfx = Gdx.audio.newSound(Gdx.files.internal(&quot;audio/dorm_door_opening.wav&quot;));</b>
<b class="nc">&nbsp;    slipSfx = Gdx.audio.newSound(Gdx.files.internal(&quot;audio/cartoon_quick_slip.wav&quot;));</b>
<b class="nc">&nbsp;    growlSfx = Gdx.audio.newSound(Gdx.files.internal(&quot;audio/deep_growl_1.wav&quot;));</b>
&nbsp;
<b class="nc">&nbsp;    player = new Player(playerTexDown, 55, 25);</b>
&nbsp;    // exit = new Item(new WinEvent(), &quot;exit&quot;, exitTexture, 80, 54, 2, 2.2f);
<b class="nc">&nbsp;    dean = new Dean(yetiTexture, 3, 57f);</b>
<b class="nc">&nbsp;    dean.disable();</b>
<b class="nc">&nbsp;    dean.hide();</b>
&nbsp;
<b class="nc">&nbsp;    MapObjects interactables = mapManager.getMap().getLayers().get(&quot;Events&quot;).getObjects();</b>
<b class="nc">&nbsp;    eventTracker = new EventTracker();</b>
<b class="nc">&nbsp;    for (int index = 0; index &lt; interactables.getCount(); index++) {</b>
<b class="nc">&nbsp;      MapObject mapObject = interactables.get(index);</b>
<b class="nc">&nbsp;      Event event = new Event(mapObject);</b>
<b class="nc">&nbsp;      entities.add(event);</b>
<b class="nc">&nbsp;      eventTracker.register(event);</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    game.fontBorderedSmall.setUseIntegerPositions(false);</b>
&nbsp;
&nbsp;    // start a new timer
<b class="nc">&nbsp;    game.timer = new Timer(TIMER_LENGTH);</b>
<b class="nc">&nbsp;    game.timer.play();</b>
<b class="nc">&nbsp;    game.score = 0;</b>
<b class="nc">&nbsp;    game.achievements.unlock(&quot;welcome_campus&quot;, game);</b>
&nbsp;
&nbsp;    // create labels and position timer and event counters on screen
<b class="nc">&nbsp;    timerText = new Label(null, new Label.LabelStyle(game.font, Color.WHITE.cpy()));</b>
<b class="nc">&nbsp;    timerText.setPosition(0, scaled(8.6f));</b>
&nbsp;
<b class="nc">&nbsp;    hiddenText = new Label(null, new Label.LabelStyle(game.fontBorderedSmall, Color.WHITE.cpy()));</b>
<b class="nc">&nbsp;    hiddenText.setPosition(scaled(3f), scaled(8.65f));</b>
&nbsp;
<b class="nc">&nbsp;    negativeText = new Label(null, new Label.LabelStyle(game.fontBorderedSmall, Color.WHITE.cpy()));</b>
<b class="nc">&nbsp;    negativeText.setPosition(scaled(6f), scaled(8.6f));</b>
&nbsp;
<b class="nc">&nbsp;    positiveText = new Label(null, new Label.LabelStyle(game.fontBorderedSmall, Color.WHITE.cpy()));</b>
<b class="nc">&nbsp;    positiveText.setPosition(scaled(9f), scaled(8.6f));</b>
&nbsp;
<b class="nc">&nbsp;    scoreText = new Label(null, new Label.LabelStyle(game.fontBorderedSmall, Color.WHITE.cpy()));</b>
<b class="nc">&nbsp;    scoreText.setPosition(scaled(12f), scaled(8.6f)); // Changed from 8.5 -&gt; 8.6 to prevent them from covering map</b>
&nbsp;
<b class="nc">&nbsp;    Gdx.input.setInputProcessor(stage);</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;    Pixmap pmUp = new Pixmap(1, 1, Pixmap.Format.RGBA8888);</b>
<b class="nc">&nbsp;    pmUp.setColor(0f, 0f, 0f, 0.8f);</b>
<b class="nc">&nbsp;    pmUp.fill();</b>
<b class="nc">&nbsp;    btnUpTex = new Texture(pmUp);</b>
<b class="nc">&nbsp;    pmUp.dispose();</b>
&nbsp;
<b class="nc">&nbsp;    Pixmap pmDown = new Pixmap(1, 1, Pixmap.Format.RGBA8888);</b>
<b class="nc">&nbsp;    pmDown.setColor(1f, 1f, 1f, 0.25f);</b>
<b class="nc">&nbsp;    pmDown.fill();</b>
<b class="nc">&nbsp;    btnDownTex = new Texture(pmDown);</b>
<b class="nc">&nbsp;    pmDown.dispose();</b>
&nbsp;
<b class="nc">&nbsp;    TextButton.TextButtonStyle btnStyle = new TextButton.TextButtonStyle();</b>
<b class="nc">&nbsp;    btnStyle.up   = new TextureRegionDrawable(new TextureRegion(btnUpTex));</b>
<b class="nc">&nbsp;    btnStyle.down = new TextureRegionDrawable(new TextureRegion(btnDownTex));</b>
<b class="nc">&nbsp;    btnStyle.over = btnStyle.down;</b>
<b class="nc">&nbsp;    btnStyle.font = game.fontBorderedSmall;</b>
<b class="nc">&nbsp;    btnStyle.fontColor = Color.WHITE.cpy();</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;    pauseMenu = new Table();</b>
<b class="nc">&nbsp;    pauseMenu.setFillParent(true);</b>
<b class="nc">&nbsp;    pauseMenu.center();</b>
&nbsp;
<b class="nc">&nbsp;    float btnW = scaled(5f);</b>
<b class="nc">&nbsp;    float btnH = scaled(1.4f);</b>
&nbsp;
<b class="nc">&nbsp;    TextButton resumeButton = new TextButton(&quot;Resume&quot;, btnStyle);</b>
<b class="nc">&nbsp;    TextButton restartButton = new TextButton(&quot;Restart&quot;, btnStyle);</b>
<b class="nc">&nbsp;    TextButton menuButton = new TextButton(&quot;Main Menu&quot;, btnStyle);</b>
&nbsp;
<b class="nc">&nbsp;    resumeButton.setSize(btnW, btnH);</b>
<b class="nc">&nbsp;    restartButton.setSize(btnW, btnH);</b>
<b class="nc">&nbsp;    menuButton.setSize(btnW, btnH);</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;    pauseMenu.defaults().width(btnW).height(btnH).pad(scaled(0.3f));</b>
<b class="nc">&nbsp;    pauseMenu.add(resumeButton).row();</b>
<b class="nc">&nbsp;    pauseMenu.add(restartButton).row();</b>
<b class="nc">&nbsp;    pauseMenu.add(menuButton).row();</b>
&nbsp;
<b class="nc">&nbsp;    pauseMenu.setVisible(false);</b>
<b class="nc">&nbsp;    stage.addActor(pauseMenu);</b>
&nbsp;
&nbsp;
<b class="nc">&nbsp;    resumeButton.addListener(new ChangeListener() {</b>
&nbsp;      @Override public void changed(ChangeEvent event, Actor actor) {
<b class="nc">&nbsp;        game.resume();</b>
&nbsp;      }
&nbsp;    });
&nbsp;
<b class="nc">&nbsp;    restartButton.addListener(new ChangeListener() {</b>
&nbsp;      @Override public void changed(ChangeEvent event, Actor actor) {
<b class="nc">&nbsp;        game.resume();</b>
<b class="nc">&nbsp;        game.setScreen(new GameScreen(game));</b>
<b class="nc">&nbsp;        dispose();</b>
&nbsp;      }
&nbsp;    });
&nbsp;
<b class="nc">&nbsp;    menuButton.addListener(new ChangeListener() {</b>
&nbsp;      @Override public void changed(ChangeEvent event, Actor actor) {
<b class="nc">&nbsp;        game.setScreen(new MenuScreen(game));</b>
<b class="nc">&nbsp;        dispose();</b>
&nbsp;      }
&nbsp;    });
&nbsp;  }
&nbsp;
&nbsp;  @Override
&nbsp;  public void render(float delta) {
<b class="nc">&nbsp;    input(delta);</b>
<b class="nc">&nbsp;    logic(delta);</b>
<b class="nc">&nbsp;    draw(delta);</b>
<b class="nc">&nbsp;    postLogic();</b>
&nbsp;  }
&nbsp;
&nbsp;  // handles player input
&nbsp;  private void input(float delta) {
<b class="nc">&nbsp;    float speed = player.getSpeedThisFrame(delta);</b>
&nbsp;
&nbsp;    // vertical movement
<b class="nc">&nbsp;    float dx = 0;</b>
<b class="nc">&nbsp;    float dy = 0;</b>
<b class="nc">&nbsp;    if (InputHelper.moveUpPressed()) {</b>
<b class="nc">&nbsp;      dy += speed;</b>
<b class="nc">&nbsp;      player.setTexture(playerTexUp);</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    if (InputHelper.moveDownPressed()) {</b>
<b class="nc">&nbsp;      dy -= speed;</b>
<b class="nc">&nbsp;      player.setTexture(playerTexDown);</b>
&nbsp;    }
&nbsp;
&nbsp;    // horizontal movement
<b class="nc">&nbsp;    if (InputHelper.moveRightPressed()) {</b>
<b class="nc">&nbsp;      dx += speed;</b>
<b class="nc">&nbsp;      player.setTexture(playerTexRight);</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    if (InputHelper.moveLeftPressed()) {</b>
<b class="nc">&nbsp;      dx -= speed;</b>
<b class="nc">&nbsp;      player.setTexture(playerTexLeft);</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    float currentX = player.getX();</b>
<b class="nc">&nbsp;    float currentY = player.getY();</b>
&nbsp;
&nbsp;    // moved to keep definitions closer together, but shouldn&#39;t cause issues with existing logic, i think
<b class="nc">&nbsp;    player.resetMovement();</b>
&nbsp;
<b class="nc">&nbsp;    Rectangle hitbox = player.getHitbox();</b>
&nbsp;
&nbsp;    // tests if collision occurs after x movement
<b class="nc">&nbsp;    hitbox.setPosition(currentX + dx, currentY);</b>
<b class="nc">&nbsp;    if (mapManager.isRectValid(player.getHitbox())) {</b>
<b class="nc">&nbsp;      player.addMovement(dx, 0);</b>
&nbsp;    }
&nbsp;
&nbsp;    // tests if collision occurs after y movement
<b class="nc">&nbsp;    hitbox.setPosition(currentX, currentY + dy);</b>
<b class="nc">&nbsp;    if (mapManager.isRectValid(player.getHitbox())) {</b>
<b class="nc">&nbsp;      player.addMovement(0, dy);</b>
&nbsp;    }
&nbsp;
&nbsp;    // sets the hitbox to correct player location
<b class="nc">&nbsp;    hitbox.setPosition(player.getX(), player.getY());</b>
&nbsp;  }
&nbsp;
&nbsp;  // handles collisions and events
&nbsp;  private void logic(float delta) {
&nbsp;    // save initial position of player
<b class="nc">&nbsp;    Vector2 currentPos = player.getCurrentPos();</b>
&nbsp;
&nbsp;    // move only if game isn&#39;t paused
<b class="nc">&nbsp;    if (!game.isPaused()) {</b>
<b class="nc">&nbsp;      player.update(delta, this);</b>
<b class="nc">&nbsp;      player.doMove(delta, true);</b>
<b class="nc">&nbsp;      if (dean.isEnabled()) {</b>
<b class="nc">&nbsp;        dean.calculateMovement(player);</b>
<b class="nc">&nbsp;        dean.doMove(delta);</b>
&nbsp;      }
&nbsp;    }
<b class="nc">&nbsp;    if (!game.isPaused()) {</b>
<b class="nc">&nbsp;      for (Entity e : entities) {</b>
<b class="nc">&nbsp;        e.update(delta);</b>
&nbsp;      }
&nbsp;    }
&nbsp;
&nbsp;    // Detect collision with objects
<b class="nc">&nbsp;    entities.forEach(e -&gt; {</b>
<b class="nc">&nbsp;      if (player.collidedWith(e) &amp;&amp; e.isEnabled()) {</b>
&nbsp;        // Check for collision with solid objects
<b class="nc">&nbsp;        if (e.isSolid()) {</b>
&nbsp;          // set the position of player to previous position if collision
<b class="nc">&nbsp;          player.setPosition(currentPos.x, currentPos.y);</b>
&nbsp;        }
&nbsp;
&nbsp;        // Check for interaction with items
<b class="nc">&nbsp;        if (e instanceof Item item) {</b>
<b class="nc">&nbsp;          item.interact(game, this, player, (Event) e, game.timer.getRemainingTime());</b>
&nbsp;        }
&nbsp;      }
&nbsp;    });
&nbsp;
&nbsp;    // Clamp to edges of screen
<b class="nc">&nbsp;    float worldWidth = game.viewport.getWorldWidth();</b>
<b class="nc">&nbsp;    float worldHeight = game.viewport.getWorldHeight();</b>
&nbsp;
<b class="nc">&nbsp;    float playerWidth = player.getWidth();</b>
<b class="nc">&nbsp;    float playerHeight = player.getHeight();</b>
&nbsp;
<b class="nc">&nbsp;    player.setX(MathUtils.clamp(player.getX(), 0, worldWidth - playerWidth));</b>
<b class="nc">&nbsp;    player.setY(MathUtils.clamp(player.getY(), 0, worldHeight - playerHeight));</b>
&nbsp;
&nbsp;    // Calculate remaining time
<b class="nc">&nbsp;    int timeRemaining = game.timer.getRemainingTime();</b>
&nbsp;
<b class="nc">&nbsp;    String text = (timeRemaining / 60) + &quot;:&quot; + String.format(&quot;%02d&quot;, timeRemaining % 60);</b>
<b class="nc">&nbsp;    timerText.setText(text);</b>
<b class="nc">&nbsp;    timerText.setStyle(new Label.LabelStyle(game.fontBordered, (game.timer.isActive() ? Color.WHITE : Color.RED).cpy()));</b>
&nbsp;
&nbsp;    // updates event counters
<b class="nc">&nbsp;    hiddenText.setText(&quot;Hidden:&quot; + EventCounter.getHiddenCount());</b>
<b class="nc">&nbsp;    positiveText.setText(&quot;Positive:&quot; + EventCounter.getPositiveCount());</b>
<b class="nc">&nbsp;    negativeText.setText(&quot;Negative:&quot; + EventCounter.getNegativeCount());</b>
<b class="nc">&nbsp;    int liveScore = game.score + game.timer.getRemainingTime();</b>
<b class="nc">&nbsp;    scoreText.setText(&quot;Score: &quot; + liveScore);</b>
&nbsp;
&nbsp;    // Release the Dean if the timer is at 60 or less
<b class="nc">&nbsp;    if (timeRemaining &lt;= 60 &amp;&amp; !dean.isEnabled()) {</b>
<b class="nc">&nbsp;      growlSfx.play(game.volume);</b>
<b class="nc">&nbsp;      spawnLargeMessage(&quot;Run! The dean is coming!&quot;);</b>
<b class="nc">&nbsp;      dean.show();</b>
<b class="nc">&nbsp;      dean.enable();</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    if (Gdx.input.isKeyJustPressed(Input.Keys.ESCAPE)) {</b>
<b class="nc">&nbsp;      if (game.isPaused()) {</b>
<b class="nc">&nbsp;        game.resume();</b>
&nbsp;      } else {
<b class="nc">&nbsp;        game.pause();</b>
<b class="nc">&nbsp;        if (!hasPausedOnce) {</b>
<b class="nc">&nbsp;          game.achievements.unlock(&quot;pause_once&quot;, game);</b>
<b class="nc">&nbsp;          hasPausedOnce = true;</b>
&nbsp;        }
&nbsp;      }
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  // draws map and entities to screen
&nbsp;  private void draw(float delta) {
<b class="nc">&nbsp;    ScreenUtils.clear(0f, 0f, 0f, 1f);</b>
<b class="nc">&nbsp;    camera.update();</b>
&nbsp;
&nbsp;    // draw map
<b class="nc">&nbsp;    mapManager.render();</b>
<b class="nc">&nbsp;    game.viewport.apply();</b>
&nbsp;
&nbsp;    // main camera with map and entities
<b class="nc">&nbsp;    game.batch.setProjectionMatrix(camera.combined);</b>
&nbsp;
<b class="nc">&nbsp;    game.batch.begin();</b>
&nbsp;
&nbsp;    // Draw only visible entities
<b class="nc">&nbsp;    entities.forEach(e -&gt; {</b>
<b class="nc">&nbsp;      if (e.isVisible()) {</b>
<b class="nc">&nbsp;        e.draw(game.batch);</b>
&nbsp;      }
&nbsp;    });
&nbsp;
&nbsp;    // Draw exit, player, and dean on top of other entities
&nbsp;    // if (exit.isVisible()) exit.draw(game.batch);
<b class="nc">&nbsp;    if (player.isVisible()) {</b>
<b class="nc">&nbsp;      player.draw(game.batch);</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    float pixelsPerUnit = (float) Gdx.graphics.getWidth() / camera.viewportWidth;</b>
<b class="nc">&nbsp;    float nameSize = 0.04f;</b>
&nbsp;
&nbsp;    // set here because the game size, and thus the value of these variables, is modified soon after
<b class="nc">&nbsp;    float originalFontScaleX = game.fontBorderedSmall.getData().scaleX;</b>
<b class="nc">&nbsp;    float originalFontScaleY = game.fontBorderedSmall.getData().scaleY;</b>
<b class="nc">&nbsp;    float scale = (nameSize * pixelsPerUnit) / game.fontBorderedSmall.getCapHeight();</b>
&nbsp;
<b class="nc">&nbsp;    game.fontBorderedSmall.getData().setScale(scale);</b>
<b class="nc">&nbsp;    nameLayout.setText(game.fontBorderedSmall, game.playerName);</b>
&nbsp;
<b class="nc">&nbsp;    float textPosX = player.getX() + (player.getWidth() - nameLayout.width) * 0.5f;</b>
<b class="nc">&nbsp;    float nameOffset = 0.2f;</b>
<b class="nc">&nbsp;    float textPosY = player.getY() + player.getHeight() + nameOffset + nameLayout.height;</b>
&nbsp;
<b class="nc">&nbsp;    Color prevFontColor = game.fontBorderedSmall.getColor().cpy();</b>
<b class="nc">&nbsp;    game.fontBorderedSmall.setColor(Color.WHITE);</b>
<b class="nc">&nbsp;    game.fontBorderedSmall.draw(game.batch, nameLayout, textPosX, textPosY);</b>
<b class="nc">&nbsp;    game.fontBorderedSmall.setColor(prevFontColor);</b>
<b class="nc">&nbsp;    game.fontBorderedSmall.getData().setScale(originalFontScaleX, originalFontScaleY);</b>
&nbsp;
<b class="nc">&nbsp;    if (dean.isVisible()) {</b>
<b class="nc">&nbsp;      dean.draw(game.batch);</b>
&nbsp;    }
<b class="nc">&nbsp;    game.batch.end();</b>
&nbsp;
&nbsp;    // separate user interface camera for text on screen
<b class="nc">&nbsp;    game.batch.setProjectionMatrix(interfaceCamera.combined);</b>
<b class="nc">&nbsp;    game.batch.begin();</b>
&nbsp;
&nbsp;    // draw timer and event counters to screen
<b class="nc">&nbsp;    timerText.draw(game.batch, 1.0f);</b>
<b class="nc">&nbsp;    hiddenText.draw(game.batch, 1.0f);</b>
<b class="nc">&nbsp;    positiveText.draw(game.batch, 1.0f);</b>
<b class="nc">&nbsp;    negativeText.draw(game.batch, 1.0f);</b>
<b class="nc">&nbsp;    scoreText.draw(game.batch, 1.0f);</b>
&nbsp;
&nbsp;    // draws messages fading out in an upwards direction
<b class="nc">&nbsp;    for (Label l : messages) {</b>
<b class="nc">&nbsp;      Float t = (Float) l.getUserObject();</b>
<b class="nc">&nbsp;      if (t == null) {</b>
<b class="nc">&nbsp;        t = 0f;</b>
&nbsp;      }
&nbsp;
<b class="nc">&nbsp;      t += delta;</b>
<b class="nc">&nbsp;      l.setUserObject(t);</b>
&nbsp;
<b class="nc">&nbsp;      float progress = Math.min(1f, t / textDuration);</b>
<b class="nc">&nbsp;      l.setY(l.getY() + riseSpeed * delta);</b>
&nbsp;
<b class="nc">&nbsp;      Color c = l.getColor();</b>
<b class="nc">&nbsp;      c.a = 1f - progress;</b>
<b class="nc">&nbsp;      l.setColor(c);</b>
&nbsp;
<b class="nc">&nbsp;      l.draw(game.batch, 1);</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    messages.removeIf(l -&gt; {</b>
<b class="nc">&nbsp;      Float t = (Float) l.getUserObject();</b>
<b class="nc">&nbsp;      return t != null &amp;&amp; t &gt;= textDuration;</b>
&nbsp;    });
&nbsp;
<b class="nc">&nbsp;    messages.removeIf(l -&gt; l.getColor().a &lt;= 0);</b>
<b class="nc">&nbsp;    game.batch.end();</b>
&nbsp;
&nbsp;    // Finally, draw elements on the stage (clickable elements)
<b class="nc">&nbsp;    pauseMenu.setVisible(game.isPaused());</b>
&nbsp;
<b class="nc">&nbsp;    stage.act(delta);</b>
<b class="nc">&nbsp;    stage.draw();</b>
&nbsp;
&nbsp;    // Achievement popups overlay (draw last so they sit above UI)
<b class="nc">&nbsp;    game.achievements.renderPopups(game, game.batch, interfaceCamera.combined, game.fontBorderedSmall, delta);</b>
&nbsp;  }
&nbsp;
&nbsp;  // Used for logic that should happen after rendering, normally screen changes
&nbsp;  private void postLogic() {
<b class="nc">&nbsp;    if (Gdx.input.isKeyJustPressed(Input.Keys.Q)) {</b>
<b class="nc">&nbsp;      int finalScore = game.calculateFinalScore();</b>
<b class="nc">&nbsp;      if (eventTracker != null &amp;&amp; eventTracker.allEventsTriggered()) {</b>
<b class="nc">&nbsp;        game.achievements.markAllEventsCompleted(game);</b>
&nbsp;      }
<b class="nc">&nbsp;      game.setScreen(new WinScreen(game, finalScore, game.playerName));</b>
&nbsp;
<b class="nc">&nbsp;      dispose();</b>
&nbsp;      return;
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    if (Gdx.input.isKeyJustPressed(Input.Keys.L)) {</b>
<b class="nc">&nbsp;      int finalScore = game.calculateFinalScore();</b>
<b class="nc">&nbsp;      game.setScreen(new LoseScreen(game, finalScore, game.playerName));</b>
<b class="nc">&nbsp;      dispose();</b>
&nbsp;      return;
&nbsp;    }
&nbsp;
&nbsp;    // Dean collision
<b class="nc">&nbsp;    if (player.collidedWith(dean) &amp;&amp; dean.isEnabled()) {</b>
<b class="nc">&nbsp;      game.achievements.unlock(&quot;caught_by_dean&quot;, game);</b>
<b class="nc">&nbsp;      dean.getsPlayer(game);</b>
&nbsp;      return;
&nbsp;    }
&nbsp;
&nbsp;    // Timer runs out, then player loses
<b class="nc">&nbsp;    if (game.timer.hasElapsed()) {</b>
<b class="nc">&nbsp;      game.timer.finish();</b>
<b class="nc">&nbsp;      game.achievements.unlock(&quot;times_up&quot;, game);</b>
<b class="nc">&nbsp;      int finalScore = game.calculateFinalScore();</b>
<b class="nc">&nbsp;      game.setScreen(new LoseScreen(game, finalScore, game.playerName));</b>
<b class="nc">&nbsp;      dispose();</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  @Override
&nbsp;  public void resize(int width, int height) {
<b class="nc">&nbsp;    game.viewport.update(width, height, true);</b>
&nbsp;  }
&nbsp;
&nbsp;  @Override
&nbsp;  public void pause() {
<b class="nc">&nbsp;    game.timer.pause();</b>
&nbsp;  }
&nbsp;
&nbsp;  @Override
&nbsp;  public void resume() {
<b class="nc">&nbsp;    game.timer.play();</b>
&nbsp;  }
&nbsp;
&nbsp;  @Override
<b class="nc">&nbsp;  public void hide() {}</b>
&nbsp;
&nbsp;  @Override
&nbsp;  public void dispose() {
<b class="nc">&nbsp;    playerTexUp.dispose();</b>
<b class="nc">&nbsp;    playerTexDown.dispose();</b>
<b class="nc">&nbsp;    playerTexLeft.dispose();</b>
<b class="nc">&nbsp;    playerTexRight.dispose();</b>
<b class="nc">&nbsp;    yetiTexture.dispose();</b>
&nbsp;
<b class="nc">&nbsp;    exitTexture.dispose();</b>
<b class="nc">&nbsp;    checkinCodeTexture.dispose();</b>
<b class="nc">&nbsp;    doorTexture.dispose();</b>
<b class="nc">&nbsp;    doorframeTexture.dispose();</b>
<b class="nc">&nbsp;    longBoiTexture.dispose();</b>
<b class="nc">&nbsp;    waterSpillTexture.dispose();</b>
&nbsp;
<b class="nc">&nbsp;    pauseTexture.dispose();</b>
<b class="nc">&nbsp;    mapManager.dispose();</b>
<b class="nc">&nbsp;    stage.dispose();</b>
&nbsp;
<b class="nc">&nbsp;    quackSfx.dispose();</b>
<b class="nc">&nbsp;    paperSfx.dispose();</b>
<b class="nc">&nbsp;    doorSfx.dispose();</b>
<b class="nc">&nbsp;    slipSfx.dispose();</b>
<b class="nc">&nbsp;    growlSfx.dispose();</b>
<b class="nc">&nbsp;    if (btnUpTex != null) {</b>
<b class="nc">&nbsp;      btnUpTex.dispose();</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    if (btnDownTex != null) {</b>
<b class="nc">&nbsp;      btnDownTex.dispose();</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Spawn a text label at the centre of the screen
&nbsp;   * that floats upwards and fades out. Used to alert the player.
&nbsp;   *
&nbsp;   * @param text The text that should be displayed.
&nbsp;   */
&nbsp;  public void spawnLargeMessage(String text) {
<b class="nc">&nbsp;    Label label = new Label(text, new Label.LabelStyle(game.fontBordered, Color.WHITE.cpy()));</b>
<b class="nc">&nbsp;    label.setPosition(scaled(8), scaled(4.5f), Align.center);</b>
<b class="nc">&nbsp;    messages.add(label);</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Spawn a small text label at the bottom right of the screen
&nbsp;   * that floats upwards and fades out. Used when interacting with Items.
&nbsp;   *
&nbsp;   * @param text The text that should be displayed.
&nbsp;   */
&nbsp;  public void spawnInteractionMessage(String text) {
<b class="nc">&nbsp;    Label label = new Label(text, new Label.LabelStyle(game.fontBorderedSmall, Color.WHITE.cpy()));</b>
<b class="nc">&nbsp;    label.setPosition(interfaceCamera.viewportWidth, label.getHeight(), Align.right);</b>
<b class="nc">&nbsp;    messages.add(label);</b>
&nbsp;  }
&nbsp;
&nbsp;  public void onEventTriggered(Event event) {
<b class="nc">&nbsp;    if (eventTracker != null) {</b>
<b class="nc">&nbsp;      eventTracker.onEventTriggered(event, game);</b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;    public Texture getDoorframeTexture() {
<b class="nc">&nbsp;        return doorframeTexture;</b>
&nbsp;    }
&nbsp;
&nbsp;    public Sound getQuackSfx() {
<b class="nc">&nbsp;        return quackSfx;</b>
&nbsp;    }
&nbsp;
&nbsp;    public Sound getPaperSfx() {
<b class="nc">&nbsp;        return paperSfx;</b>
&nbsp;    }
&nbsp;
&nbsp;    public Sound getDoorSfx() {
<b class="nc">&nbsp;        return doorSfx;</b>
&nbsp;    }
&nbsp;
&nbsp;    public Sound getSlipSfx() {
<b class="nc">&nbsp;        return slipSfx;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @return The current YettiGame object.
&nbsp;     */
&nbsp;    public YettiGame getGame() {
<b class="nc">&nbsp;        return game;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2026-01-02 16:28</div>
</div>
</body>
</html>
